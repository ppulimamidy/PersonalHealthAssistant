# Enhanced Traefik Configuration for Personal Health Assistant
# Main configuration file with forward authentication and advanced middleware

global:
  checkNewVersion: false
  sendAnonymousUsage: false

# API and Dashboard
api:
  dashboard: true
  insecure: true  # Only for development - use secure in production

# Entry points
entryPoints:
  web:
    address: ":80"
    # Remove HTTPS redirect for development
  websecure:
    address: ":443"
    # Remove TLS configuration for development

# Providers
providers:
  docker:
    endpoint: "unix:///var/run/docker.sock"
    exposedByDefault: false
    network: "personalhealthassistant_default"
  file:
    directory: "/etc/traefik/config"
    watch: true

# Remove certificate resolver for development
# certificatesResolvers:
#   letsencrypt:
#     acme:
#       email: "admin@personalhealthassistant.com"
#       storage: "/etc/traefik/acme.json"
#       httpChallenge:
#         entryPoint: web

# Logging
log:
  level: INFO
  format: json

# Access logs
accessLog:
  filePath: "/var/log/traefik/access.log"
  format: json
  fields:
    defaultMode: keep
    headers:
      defaultMode: keep
      names:
        Authorization: keep
        X-Forwarded-For: keep
        X-Real-IP: keep
        X-Request-ID: keep
        X-User-Id: keep
        X-User-Roles: keep

# Metrics
metrics:
  prometheus:
    buckets:
      - 0.1
      - 0.3
      - 1.2
      - 5.0

# Ping endpoint for health checks
ping:
  entryPoint: web

# Health check configuration
healthcheck:
  interval: "30s"
  timeout: "5s" 